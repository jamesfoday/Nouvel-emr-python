<div class="fixed inset-0 z-50">
  <div class="absolute inset-0 bg-black/30" onclick="document.getElementById('modal-root').innerHTML=''"></div>
  <div class="absolute inset-0 grid place-items-center p-4">
    <div class="w-full max-w-xl rounded-2xl border border-white/30 bg-white/95 shadow-2xl backdrop-blur p-5">
      <div class="flex items-center justify-between">
        <h2 class="text-lg font-semibold text-gray-900">Review External Result</h2>
        <button class="rounded-lg bg-gray-900/90 px-2 py-1 text-xs font-semibold text-white"
                onclick="document.getElementById('modal-root').innerHTML=''">Close</button>
      </div>

      <div class="mt-3 space-y-1 text-sm text-gray-800">
        <div><span class="font-medium">Patient:</span> {{ er.patient.get_full_name|default:er.patient }}</div>
        {% if er.order %}
          <div><span class="font-medium">Order:</span> {{ er.order.catalog.name }} ({{ er.order.catalog.code }})</div>
        {% endif %}
        <div><span class="font-medium">From:</span> {{ er.vendor_name|default:"External" }}</div>
        {% if er.performed_at %}<div><span class="font-medium">Performed at:</span> {{ er.performed_at|date:"D, M j Y Â· H:i" }}</div>{% endif %}
        {% if er.notes %}<div><span class="font-medium">Notes:</span> {{ er.notes }}</div>{% endif %}
        <div class="mt-2">
          <a class="text-emerald-700 underline" href="{{ er.file.url }}" target="_blank">Open uploaded file</a>
        </div>
      </div>

      <form method="post" class="mt-5 flex items-center justify-end gap-2"
            action="{% url 'labs_ui:external_result_decision' clinician.pk er.id %}">
        {% csrf_token %}
        <button name="action" value="reject" class="rounded-xl bg-gray-100 px-3 py-1.5 text-sm font-semibold text-gray-800 hover:bg-gray-200">Reject</button>
        <button name="action" value="accept" class="rounded-xl bg-emerald-600 px-3 py-1.5 text-sm font-semibold text-white hover:brightness-95">Accept</button>
      </form>
    </div>
  </div>
</div>
